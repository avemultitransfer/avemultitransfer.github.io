import{_ as O,T as R,g as j,f as q,a as z}from"./TokenIcon.86576198.js";import{k as U,i as W,j as J,u as G,l as b,c as B,D as H,r as h,o as d,g as m,d as g,b as o,t as u,F as y,n as I,f as a,w as C,bq as K,a as A,B as p,h as P,T as Q,p as w}from"./index.b2307c97.js";const X={class:"content"},Y={class:"p-16"},Z={class:"network"},ee={class:"network-list"},te=["onClick"],se={class:"item-left"},oe={class:"left-content"},ae={class:"token-name"},ne={class:"token-address"},le={class:"item-right"},ce={class:"item-right-left"},ie={class:"qty"},re={class:"amount"},de={class:"item-right-right"},ue={__name:"SelectToken",setup(ke){const T=U("global"),x=W(),c=J();G();const F=b([]),k=b([]),i=b(""),S=B(()=>i.value?i.value.startsWith("0x")?k.value.filter(e=>e.address.toLowerCase()==i.value.toLowerCase()):k.value.filter(e=>e.symbol.toLowerCase().indexOf(i.value.toLowerCase())>-1):k.value),v={text:"BSC",value:"bsc",isAllow:!0},r=b({text:v.text,value:v.value,isAllow:v.isAllow}),$=B(()=>{let e=[v];for(let n of F.value){let l=T.cfg.allowChainList.some(f=>f.chain==n.chain),_={text:n.chain.toUpperCase(),value:n.chain,isAllow:l};e.push(_)}return e});async function N(e){!e.isAllow||r.value.value!=e.value&&(r.value=e,L())}async function L(){if(r.value.value=="tbsc"){k.value=[{address:"0x0000000000000000000000000000000000000000",tokenId:"0x0000000000000000000000000000000000000000-bsc",chain:"bsc",symbol:"BNB",decimals:18,icon:"https://ave.s3.ap-east-1.amazonaws.com/token_icon/bsc/0x0000000000000000000000000000000000000000.png",amount:.19955571,price:290.2},{address:"0x227A05695F10B591731Fd925396b548a45067798",tokenId:"0x227A05695F10B591731Fd925396b548a45067798-bsc",chain:"bsc",symbol:"JF",decimals:18,icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:99999,price:1},{address:"0xfBFB9B43aE76322a804b69A5f36671312541dd0F",tokenId:"0xfBFB9B43aE76322a804b69A5f36671312541dd0F-bsc",chain:"bsc",symbol:"BT",decimals:18,icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:99999,price:1}];return}let e=[];const n=Q.loading({message:"Loading...",forbidClick:!0,duration:0});r.value.value=="all"?e=await w.debank.getAllTokenList(c.walletAddress):e=await w.debank.getTokenList(c.walletAddress,r.value.value);let l=[];for(let t of e.data.data)t.token=="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"&&(t.token=w.wallet.MAIN_COIN_ADDRESS),new RegExp("^0x.*$","gi").test(t.token)&&l.push({address:t.token.toLowerCase(),tokenId:`${t.token}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:z(t.chain.toLowerCase(),t.token.toLowerCase()),amount:t.value,price:t.current_price_usd});let _=l.map(t=>t.tokenId),f=await w.tools.tokenlistcheck(_);k.value=l.filter(t=>t.address=="0x0000000000000000000000000000000000000000"||f.data[t.tokenId].riskScore<60),n.clear()}function V(e){c.token=e,x.push("/")}function E(){x.push("/")}async function D(){c.isConnectWallet&&await L()}return H(()=>{console.log("onMounted"),D()}),(e,n)=>{const l=h("van-search"),_=h("van-icon"),f=h("van-cell"),t=h("van-list");return d(),m("div",null,[g(l,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=s=>i.value=s),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel"),onCancel:E},null,8,["modelValue","placeholder","action-text"]),o("div",X,[o("div",Y,u(e.$t("myAssets")),1),o("div",Z,[o("ul",ee,[(d(!0),m(y,null,I(a($),s=>(d(),m("li",{class:K(r.value.value==s.value?"network-selected":""),onClick:M=>N(s)},u(s.text),11,te))),256))])]),o("div",null,[g(t,{"finished-text":e.$t("noMore"),class:"token-list"},{default:C(()=>[(d(!0),m(y,null,I(a(S),s=>(d(),A(f,{class:"item",key:s,onClick:M=>V(s)},{title:C(()=>[o("div",se,[g(R,{class:"token-icon",tokenIcon:s.icon,chainIcon:a(j)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",oe,[o("div",ae,u(s.symbol),1),o("div",ne,u(a(q)(s.address)),1)])])]),value:C(()=>[o("div",le,[o("div",ce,[o("div",ie,u(a(p)(s.amount).toString().indexOf(".")==-1?a(p)(s.amount):a(p)(s.amount).toFixed(6)),1),o("div",re,"$"+u(a(p)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",de,[a(c).token&&a(c).token.address==s.address?(d(),A(_,{key:0,name:"success",color:"#3F80F7"})):P("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},ve=O(ue,[["__scopeId","data-v-04f2f883"]]);export{ve as default};
