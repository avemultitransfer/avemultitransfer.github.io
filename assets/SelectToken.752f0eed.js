import{_ as O,T as R,g as j,f as q,a as z}from"./TokenIcon.65e38c24.js";import{k as U,i as W,j as J,u as G,l as v,c as B,D as H,r as h,o as r,g as m,d as g,b as o,t as u,F as y,n as I,f as a,w as C,bq as K,a as A,B as p,h as P,T as Q,p as w}from"./index.92e5f7c2.js";const X={class:"content"},Y={class:"p-16"},Z={class:"network"},ee={class:"network-list"},te=["onClick"],se={class:"item-left"},oe={class:"left-content"},ae={class:"token-name"},ne={class:"token-address"},le={class:"item-right"},ce={class:"item-right-left"},ie={class:"qty"},de={class:"amount"},re={class:"item-right-right"},ue={__name:"SelectToken",setup(_e){const T=U("global"),x=W(),c=J();G();const F=v([]),_=v([]),i=v(""),S=B(()=>i.value?i.value.startsWith("0x")?_.value.filter(e=>e.address.toLowerCase()==i.value.toLowerCase()):_.value.filter(e=>e.symbol.toLowerCase().indexOf(i.value.toLowerCase())>-1):_.value),f={text:"BSC",value:"bsc",isAllow:!0},d=v({text:f.text,value:f.value,isAllow:f.isAllow}),$=B(()=>{let e=[f];for(let n of F.value){let l=T.cfg.allowChainList.some(k=>k.chain==n.chain),b={text:n.chain.toUpperCase(),value:n.chain,isAllow:l};e.push(b)}return e});async function N(e){!e.isAllow||d.value.value!=e.value&&(d.value=e,L())}async function L(){if(d.value.value=="tbsc"){_.value=[{address:"0x0000000000000000000000000000000000000000",tokenId:"0x0000000000000000000000000000000000000000-bsc",chain:"bsc",symbol:"BNB",decimals:18,icon:"https://ave.s3.ap-east-1.amazonaws.com/token_icon/bsc/0x0000000000000000000000000000000000000000.png",amount:.19955571,price:290.2},{address:"0x227A05695F10B591731Fd925396b548a45067798",tokenId:"0x227A05695F10B591731Fd925396b548a45067798-bsc",chain:"bsc",symbol:"JF",decimals:18,icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:99999,price:1},{address:"0xfBFB9B43aE76322a804b69A5f36671312541dd0F",tokenId:"0xfBFB9B43aE76322a804b69A5f36671312541dd0F-bsc",chain:"bsc",symbol:"BT",decimals:18,icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:99999,price:1}];return}let e=[];const n=Q.loading({message:"Loading...",forbidClick:!0,duration:0});d.value.value=="all"?e=await w.debank.getAllTokenList(c.walletAddress):e=await w.debank.getTokenList(c.walletAddress,d.value.value);let l=[];for(let t of e.data)t.id=="bsc"&&(t.id=w.wallet.MAIN_COIN_ADDRESS),new RegExp("^0x.*$","gi").test(t.id)&&l.push({address:t.id.toLowerCase(),tokenId:`${t.id}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:z(t.chain.toLowerCase(),t.id.toLowerCase()),amount:t.amount,price:t.price});let b=l.map(t=>t.tokenId),k=await w.tools.tokenlistcheck(b);_.value=l.filter(t=>t.address=="0x0000000000000000000000000000000000000000"||k.data[t.tokenId].riskScore<60),n.clear()}function V(e){c.token=e,x.push("/")}function E(){x.push("/")}async function D(){c.isConnectWallet&&await L()}return H(()=>{console.log("onMounted"),D()}),(e,n)=>{const l=h("van-search"),b=h("van-icon"),k=h("van-cell"),t=h("van-list");return r(),m("div",null,[g(l,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=s=>i.value=s),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel"),onCancel:E},null,8,["modelValue","placeholder","action-text"]),o("div",X,[o("div",Y,u(e.$t("myAssets")),1),o("div",Z,[o("ul",ee,[(r(!0),m(y,null,I(a($),s=>(r(),m("li",{class:K(d.value.value==s.value?"network-selected":""),onClick:M=>N(s)},u(s.text),11,te))),256))])]),o("div",null,[g(t,{"finished-text":e.$t("noMore"),class:"token-list"},{default:C(()=>[(r(!0),m(y,null,I(a(S),s=>(r(),A(k,{class:"item",key:s,onClick:M=>V(s)},{title:C(()=>[o("div",se,[g(R,{class:"token-icon",tokenIcon:s.icon,chainIcon:a(j)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",oe,[o("div",ae,u(s.symbol),1),o("div",ne,u(a(q)(s.address)),1)])])]),value:C(()=>[o("div",le,[o("div",ce,[o("div",ie,u(a(p)(s.amount).toString().indexOf(".")==-1?a(p)(s.amount):a(p)(s.amount).toFixed(6)),1),o("div",de,"$"+u(a(p)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",re,[a(c).token&&a(c).token.address==s.address?(r(),A(b,{key:0,name:"success",color:"#3F80F7"})):P("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},fe=O(ue,[["__scopeId","data-v-20f7dbb5"]]);export{fe as default};
